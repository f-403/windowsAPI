å¤ªå¥½äº†ï¼ä¸‹é¢æˆ‘ä¸ºä½ æ•´ç†äº†**C++ å››ç§ç±»å‹è½¬æ¢ï¼ˆcastï¼‰è¯­æ³•çš„å¯¹æ¯”è¡¨**ã€é€‚ç”¨åœºæ™¯ã€æ³¨æ„äº‹é¡¹ï¼Œå¹¶é™„å¸¦é”™è¯¯ç”¨æ³•çš„**ç¤ºä¾‹å’Œè§£é‡Š**ã€‚

---

## ğŸ“˜ ä¸€å¼ è¡¨çœ‹æ‡‚ C++ å››ç§ç±»å‹è½¬æ¢ cast

| è½¬æ¢æ–¹å¼                        | è¯­æ³•               | ç”¨é€”                          | æ˜¯å¦ç±»å‹å®‰å…¨    | ç”¨ä¾‹                                | å¸¸è§é£é™©            |
| --------------------------- | ---------------- | --------------------------- | --------- | --------------------------------- | --------------- |
| `static_cast<T>(expr)`      | é™æ€è½¬æ¢             | åŸºæœ¬ç±»å‹é—´è½¬æ¢ã€ç±»é—´å‘ä¸Š/å‘ä¸‹è½¬æ¢ï¼ˆæœ‰ç»§æ‰¿å…³ç³»ï¼‰    | âœ…         | `int â†’ float`ã€`Base* â†’ Derived*`  | å‘ä¸‹è½¬æ—¶æ— è¿è¡Œæ—¶æ£€æŸ¥ï¼Œå¯èƒ½å´©æºƒ |
| `const_cast<T>(expr)`       | å» const/volatile | æ·»åŠ /ç§»é™¤ const æˆ– volatile é™å®šç¬¦  | âœ…ï¼ˆä½ ä¿è¯ä¸è¿è§„ï¼‰ | `const char* â†’ char*`             | åŸå¯¹è±¡æ˜¯å¸¸é‡æ—¶å†™æ“ä½œä¼š UB  |
| `reinterpret_cast<T>(expr)` | é‡æ–°è§£é‡Šå†…å­˜           | æŒ‡é’ˆ â†” æŒ‡é’ˆã€æŒ‡é’ˆ â†” æ•´æ•°ï¼ˆuintptr\_tï¼‰ | âŒ         | `int* â†’ char*`ã€`void* â†’ MyClass*` | éå…¼å®¹ç±»å‹ä½¿ç”¨ä¼šå¯¼è‡´ UB   |
| `dynamic_cast<T>(expr)`     | åŠ¨æ€è½¬æ¢ï¼ˆè¿è¡Œæ—¶æ£€æŸ¥ï¼‰      | ç±»æŒ‡é’ˆ/å¼•ç”¨é—´å®‰å…¨è½¬æ¢ï¼ˆéœ€è™šå‡½æ•°ï¼‰           | âœ…ï¼ˆæœ‰ç±»å‹æ£€æŸ¥ï¼‰  | `Base* â†’ Derived*`                | ä»…é€‚ç”¨äºå¤šæ€ç±»ï¼Œæœ‰å¼€é”€     |

---

## ğŸ” æ¯ç§ç±»å‹è½¬æ¢è¯¦ç»†ç¤ºä¾‹ä¸é£é™©

---

### 1ï¸âƒ£ `static_cast`

âœ… ç”¨äºå®‰å…¨çš„åŸºæœ¬ç±»å‹è½¬æ¢ã€ç±»å±‚æ¬¡ç»“æ„ä¸­çš„â€œå·²çŸ¥å®‰å…¨â€è½¬æ¢ã€‚

```cpp
int i = 42;
float f = static_cast<float>(i); // âœ… å®‰å…¨
```

âš ï¸ å‘ä¸‹è½¬æŒ‡é’ˆæ—¶éœ€è‡ªå·±ä¿è¯ç±»å‹æ­£ç¡®ï¼š

```cpp
class Base {};
class Derived : public Base {};
Base* base = new Derived();
Derived* d = static_cast<Derived*>(base);  // âš ï¸ ä½ è¦è‡ªå·±ç¡®ä¿ base å®é™…æŒ‡å‘ Derived
```

---

### 2ï¸âƒ£ `const_cast`

âœ… ç”¨äºç§»é™¤ `const` é™å®šï¼Œè®©ä½ èƒ½è°ƒç”¨ä¸æ¥å— `const` çš„æ—§ APIï¼š

```cpp
void print(char* data) { std::cout << data; }

const char* msg = "hello";
print(const_cast<char*>(msg));  // âœ… å¯ç¼–è¯‘ï¼Œä½†ä½ ä¸èƒ½ä¿®æ”¹ msg å†…å®¹ï¼
```

âš ï¸ å¦‚æœçœŸçš„å»å†™è¿™ä¸ªåªè¯»å†…å­˜ï¼Œä¼š **å´©æºƒæˆ– UB**ï¼š

```cpp
char* hack = const_cast<char*>("hello");
hack[0] = 'H';  // âŒ UBï¼Œå¯èƒ½æ®µé”™è¯¯
```

---

### 3ï¸âƒ£ `reinterpret_cast`

âœ… ç”¨äºæŒ‡é’ˆã€å­—èŠ‚æµã€åº•å±‚æ•°æ®è½¬æ¢ï¼š

```cpp
const wchar_t* str = L"Tom";
const BYTE* data = reinterpret_cast<const BYTE*>(str); // âœ… ä¼ ç»™ RegSetValueExW
```

âš ï¸ ä¸èƒ½ç”¨äºæ•°å€¼ä¹‹é—´çš„ç›´æ¥è½¬æ¢ï¼ˆä¸æ˜¯å®ƒçš„ç”¨é€”ï¼‰ï¼š

```cpp
int i = 123;
float f = reinterpret_cast<float&>(i);  // âŒ UBï¼šfloat ç»“æ„å’Œ int ä¸å…¼å®¹ï¼
```

---

### 4ï¸âƒ£ `dynamic_cast`

âœ… å¤šæ€ç±»ä¸­å‘ä¸‹è½¬å®‰å…¨ï¼ˆå¸¦ç±»å‹æ£€æŸ¥ï¼‰ï¼š

```cpp
class Base { public: virtual ~Base() {} };
class Derived : public Base {};
Base* base = new Derived();

Derived* d = dynamic_cast<Derived*>(base);  // âœ… OK
```

âŒ éå¤šæ€ç±»ä¸­ä½¿ç”¨ä¼šç¼–è¯‘å¤±è´¥ï¼š

```cpp
class A {};
class B : public A {};
A* a = new B();
// B* b = dynamic_cast<B*>(a);  // âŒ ç¼–è¯‘é”™è¯¯ï¼šæ²¡æœ‰è™šå‡½æ•°
```

---

## ğŸ§¨ é”™è¯¯ç”¨æ³•ç¤ºä¾‹å¯¹æ¯”

| âŒ é”™è¯¯ç”¨æ³•                          | åŸå›               | æ­£ç¡®æ–¹å¼                           |
| ------------------------------- | --------------- | ------------------------------ |
| `(BYTE)(ptr)`                   | æŠŠæŒ‡é’ˆè½¬æˆæ•°å€¼å†æˆªæ–­ï¼Œæ¯«æ— æ„ä¹‰ | `reinterpret_cast<BYTE*>(ptr)` |
| `reinterpret_cast<int>(x)`      | x æœ¬èº«æ˜¯ intï¼Œä¸å…è®¸è½¬æ¢ | ä¸éœ€è¦ castï¼Œç›´æ¥ `int x`            |
| `reinterpret_cast<float>(123)`  | åŸºæœ¬ç±»å‹è½¬æ¢éæ³•        | ç”¨ `static_cast<float>(123)`    |
| `const_cast<char*>("abc")` ç„¶åå†™å…¥ | å­—é¢é‡æ˜¯åªè¯»å†…å­˜ï¼Œå†™å…¥ä¼šå´©æºƒ  | ä¸è¦ä¿®æ”¹ string literal            |

---

## âœ… æ€»ç»“å›¾ç¤ºï¼šä½¿ç”¨é€‰æ‹©æŒ‡å—

```text
[ä½ æƒ³åšçš„æ˜¯ï¼Ÿ]
      â”‚
      â”œâ”€ åŸºæœ¬ç±»å‹è½¬æ¢ï¼Ÿâ”€â”€â”€â–º static_cast
      â”‚
      â”œâ”€ å»æ‰ constï¼Ÿâ”€â”€â”€â”€â”€â–º const_cast
      â”‚
      â”œâ”€ æŒ‡é’ˆ/å­—èŠ‚å¼ºè½¬ï¼Ÿâ”€â”€â–º reinterpret_cast
      â”‚
      â”œâ”€ å¤šæ€ç±»å‘ä¸‹è½¬ï¼Ÿâ”€â”€â”€â–º dynamic_castï¼ˆå¿…é¡»æœ‰è™šå‡½æ•°ï¼‰
      â”‚
      â””â”€ å…¶ä»–ï¼Ÿå¯èƒ½ä½ è¯¥é‡æ„ä»£ç äº† ğŸ¤¨
```

---

å¦‚æœä½ éœ€è¦æˆ‘åšä¸€ä»½å¯ä¸‹è½½çš„ Markdown æˆ– PDF æ ¼å¼çš„ã€ŠC++ ç±»å‹è½¬æ¢ cast å…¨è§£ã€‹ï¼Œæˆ‘å¯ä»¥ç«‹å³ç”Ÿæˆç»™ä½ ã€‚æ˜¯å¦éœ€è¦ï¼Ÿ
